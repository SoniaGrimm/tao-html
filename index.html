<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Philou te parle</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: white;
    }
    canvas {
      display: block;
      width: 100vw;
      height: 100vh;
    }
  </style>
</head>
<body>
  <canvas id="live2dCanvas"></canvas>

  <!-- ðŸ“¦ Cubism 4 Runtime for Web -->
  <script src="https://unpkg.com/@cubism/cubism4@1.0.1/dist/live2dcubismcore.min.js"></script>
  <script src="https://unpkg.com/@cubism/cubism4@1.0.1/dist/framework.min.js"></script>

  <script>
    const canvas = document.getElementById("live2dCanvas");

    // Charger le Live2D
    fetch("philou_corrected.model3.json")
      .then(res => res.json())
      .then(async json => {
        const { Live2DCubismFramework } = window;

        // CrÃ©ation du manager
        const manager = new Live2DCubismFramework.CubismFramework();
        Live2DCubismFramework.CubismFramework.startUp();
        Live2DCubismFramework.CubismFramework.initialize();

        // Charger le fichier .moc3
        const moc3 = await fetch(json.FileReferences.Moc).then(r => r.arrayBuffer());
        const moc = Live2DCubismFramework.CubismMoc.create(moc3);
        const model = moc.createModel();

        // Ajouter au canvas
        const gl = canvas.getContext("webgl");
        model.saveParameters();
        model.update();
        model.draw(gl);

        // ðŸŽ¤ Voix du navigateur
        const phrase = new SpeechSynthesisUtterance("Salut, moi c'est Philou !");
        phrase.lang = "fr-FR";
        speechSynthesis.speak(phrase);
      });
  </script>
</body>
</html>